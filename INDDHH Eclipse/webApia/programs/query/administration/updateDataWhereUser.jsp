<%@page import="com.dogma.vo.*"%><%@page import="com.dogma.vo.custom.*"%><%@page import="com.dogma.business.*"%><%@page import="com.dogma.bean.scheduler.SchedulerBean"%><%@page import="com.dogma.dao.DataBaseDAO"%><%@page import="java.util.*"%><%@page import="com.dogma.util.DogmaUtil"%><%@page import="com.dogma.util.DogmaUtil"%><%@page import="com.dogma.business.querys.factory.*" %><div type="tab" style="visibility:hidden" tabTitle="<%=LabelManager.getToolTip(labelSet,"tabQryWhereUser")%>" tabText="<%=LabelManager.getName(labelSet,"tabQryWhereUser")%>"><DIV class="subTit"><%=LabelManager.getName(labelSet,"sbtQryData")%></DIV><table class="tblFormLayout"><COL class="col1"><COL class="col2"><COL class="col3"><COL class="col4"><tr><%
					   			if (QueryVo.SOURCE_BUS_CLASS.equals(queryVo.getSource())) { %><td title="<%=LabelManager.getToolTip(labelSet,"lblBusClass")%>"><%=LabelManager.getName(labelSet,"lblBusClass")%>:</td><%
						   		} else if (QueryVo.SOURCE_CONNECTION.equals(queryVo.getSource())) { %><td title="<%=LabelManager.getToolTip(labelSet,"lblQryView")%>"><%=LabelManager.getName(labelSet,"lblQryView")%>:</td><%
						   		} else { %><td></td><%
						   		} %><td><%=dBean.fmtHTML(name)%></td><td title="<%=LabelManager.getToolTip(labelSet,"lblQryType")%>"><%=LabelManager.getName(labelSet,"lblQryType")%>:</td><td><% out.print(LabelManager.getName(labelSet,qryTypeLabel)); %></td></tr><tr><td title="<%=LabelManager.getToolTip(labelSet,"lblHideFilter")%>"><%=LabelManager.getNameWAccess(labelSet,"lblHideFilter")%></td><td><input type="checkbox" id="chkHideFilter" name="chkHideFilter" <%if(queryVo!=null && queryVo.getFlagValue(IQueryFlags.FLAG_HIDE_FILTER)) {%>checked="true"<%}%> accesskey="<%=LabelManager.getNameWAccess(labelSet,"lblHideFilter")%>"></td><td></td><td></td></tr></table><DIV class="subTit"><%=LabelManager.getName(labelSet,"sbtQryWhereUsu")%></DIV><div type="grid" id="gridUser" style="height:200px"><table id="tblUser"  width="1570px" cellpadding="0" cellspacing="0"><thead><tr><th style="width:0px;display:none;" title="<%=LabelManager.getToolTip(labelSet,"lblSel")%>"></th><th min_width="250px" style="width:250px" title="<%=LabelManager.getToolTip(labelSet,"lblQryColName")%>"><%=LabelManager.getName(labelSet,"lblQryColName")%></th><% if (queryVo.isFreeSQL()) { %><th min_width="50px" style="width:50px" title="<%=LabelManager.getToolTip(labelSet,"lblQryColType")%>"><%=LabelManager.getName(labelSet,"lblQryColType")%></th><% } %><th style="display:none"></th><th min_width="150px" style="width:150px" title="<%=LabelManager.getToolTip(labelSet,"lblQryColHeadName")%>"><%=LabelManager.getName(labelSet,"lblQryColHeadName")%></th><th min_width="150px" style="width:150px" title="<%=LabelManager.getToolTip(labelSet,"lblTooTip")%>"><%=LabelManager.getName(labelSet,"lblTooTip")%></th><th min_width="150px" style="width:150px" title="<%=LabelManager.getToolTip(labelSet,"lblQryValueDef")%>"><%=LabelManager.getName(labelSet,"lblQryValueDef")%></th><th min_width="100px" style="width:100px<% if (queryVo.getFlagValue(QueryVo.FLAG_TO_PROCEDURE)) { %>;display:none<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblQryConFil")%>"><%=LabelManager.getName(labelSet,"lblQryConFil")%></th><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblReq")%>"><%=LabelManager.getName(labelSet,"lblReq")%></th><th min_width="120px" style="width:120px" title="<%=LabelManager.getToolTip(labelSet,"lblQryShowCmb")%>"><%=LabelManager.getName(labelSet,"lblQryShowCmb")%></th><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblQryExecOnCha")%>"><%=LabelManager.getName(labelSet,"lblQryExecOnCha")%></th><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblQryShowTime")%>"><%=LabelManager.getName(labelSet,"lblQryShowTime")%></th><th min_width="100px" style="width:110px" title="<%=LabelManager.getToolTip(labelSet,"lblQryShow2Col")%>"><%=LabelManager.getName(labelSet,"lblQryShow2Col")%></th><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblQryUseUpper")%>"><%=LabelManager.getName(labelSet,"lblQryUseUpper")%></th><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblReadOnly")%>"><%=LabelManager.getName(labelSet,"lblReadOnly")%></th><th min_width="150px" style="width:150px" title="<%=LabelManager.getToolTip(labelSet,"lblEnt")%>"><%=LabelManager.getName(labelSet,"lblEnt")%></th><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblQryHidSelFilType")%>"><%=LabelManager.getName(labelSet,"lblQryHidSelFilType")%></th><% if (QueryVo.TYPE_QUERY.equals(queryVo.getQryType())) { %><th min_width="100px" style="width:100px" title="<%=LabelManager.getToolTip(labelSet,"lblQryAvoidAutoFilter")%>"><%=LabelManager.getName(labelSet,"lblQryAvoidAutoFilter")%></th><%
										} %></tr></thead><tbody id="tblUserBody"><%
	 								if (queryVo.getWhereUserColumns() != null){
	 									Iterator itShow = queryVo.getWhereUserColumns().iterator();
	  									while (itShow.hasNext()) {
	 										QryColumnVo columnVo = (QryColumnVo) itShow.next(); 
	 										Integer filType = null;
	 										try {
	 											filType = new Integer(columnVo.getQryColTypeFilter());
	 										} catch (Exception e) {
	 											filType = new Integer(0);
	 										}
	 										boolean donShowRow = QueryColumns.COLUMN_REG_DATE.equalsIgnoreCase(columnVo.getQryColName()) && QueryVo.TYPE_MON_ENTITY.equals(queryVo.getQryType()); %><tr <%= donShowRow ? "style=\"display:none\"" : "" %>><td style="width:0px;display:none;"><input type="hidden" name="chkUserSel" ><input type=hidden name="hidUserColId" value="<%=dBean.fmtInt(columnVo.getQryColId())%>"><input type=hidden name="hidUserAttId" value="<%=dBean.fmtInt(columnVo.getAttId())%>"><% if (!queryVo.isFreeSQL()) { %><input type=hidden name="hidUserDatType" value="<%=dBean.fmtStr(columnVo.getQryColDataType())%>"><% } %><% if (!queryVo.isFreeSQL()) { %><input type=hidden name="hidUserColName" value="<%=dBean.fmtStr(columnVo.getQryColName())%>"><% } %><input type=hidden name="hidUserDbType" value="<%=dBean.fmtStr(columnVo.getQryColDbType())%>"><input type=hidden name="hidUserParId" value="<%=dBean.fmtInt(columnVo.getBusClaParId())%>"></td><td ><% if (queryVo.isFreeSQL()) { %><input type="text" p_required=true name="hidUserColName" value="<%=dBean.fmtStr(columnVo.getQryColName()) %>"><%} else { %><%=dBean.fmtStr(columnVo.getQryColName())%><% } %></td><% if (queryVo.isFreeSQL()) { %><td><select name="hidUserDatType" onchange="updateRowElements()" ><option value="<%=QryColumnVo.COLUMN_DATA_STRING%>" <%if(QryColumnVo.COLUMN_DATA_STRING.equals(columnVo.getQryColDataType())) {out.print("selected");}%>><%=LabelManager.getName(labelSet,"lblStr")%></option><option value="<%=QryColumnVo.COLUMN_DATA_NUMBER%>" <%if(QryColumnVo.COLUMN_DATA_NUMBER.equals(columnVo.getQryColDataType())) {out.print("selected");}%>><%=LabelManager.getName(labelSet,"lblNum")%></option><option value="<%=QryColumnVo.COLUMN_DATA_DATE%>" <%if(QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType())) {out.print("selected");}%>><%=LabelManager.getName(labelSet,"lblFec")%></option></select></td><% } %><td style="display:none" ><%=dBean.fmtStr(columnVo.getQryColName())%></td><td align="center" ><input p_required=true name="txtUserHeadName" maxlength="50" type="text" value="<%=dBean.fmtStr(columnVo.getQryColHeadName())%>" ></td><td align="center" ><input name="txtUserTool" maxlength="255" type="text" value="<%=dBean.fmtStr(columnVo.getQryColTooltip())%>" ></td><td align="center" ><input name='txtUserVal' type='text' maxlength="100" value='<%=dBean.fmtStr(columnVo.getQryColValue())%>' <% if (QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL()) { %> class="txtDate" size='10' p_mask="<%=DogmaUtil.getHTMLDateMask(dBean.getEnvId(request))%>" p_calendar="true"<%} else if (QryColumnVo.COLUMN_DATA_NUMBER.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL()) { %> p_numeric='true'<%} else if (QryColumnVo.COLUMN_DATA_STRING.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL()) { %> maxlength='100'<%} %> ></td><td align="center" ><select name="cmbUsuFilter"><option value=""></option><%if(columnVo.getQryColDataType().equals(QryColumnVo.COLUMN_DATA_STRING) || queryVo.isFreeSQL()){%><option value='<%= IQueryFilter.STRING_TYPE_EQUAL %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_EQUAL == filType.intValue())? "selected":"" %>><%=LabelManager.getName(labelSet,"lblFilEqu")%></option><option value='<%= IQueryFilter.STRING_TYPE_STARTS_WITH %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_STARTS_WITH == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilLikRig") %></option><option value='<%= IQueryFilter.STRING_TYPE_ENDS_WITH %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_ENDS_WITH == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilLikLef") %></option><option value='<%= IQueryFilter.STRING_TYPE_LIKE %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_LIKE == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilLik") %></option><option value='<%= IQueryFilter.STRING_TYPE_NOT_EQUAL %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_NOT_EQUAL == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilNotEqu") %></option><option value='<%= IQueryFilter.STRING_TYPE_NOT_STARTS_WITH %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_NOT_STARTS_WITH == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilNotLikRig") %></option><option value='<%= IQueryFilter.STRING_TYPE_NOT_ENDS_WITH %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_NOT_ENDS_WITH == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilNotLikLef") %></option><option value='<%= IQueryFilter.STRING_TYPE_NOT_LIKE %>' validFor="<%= QryColumnVo.COLUMN_DATA_STRING %>" <%= (IQueryFilter.STRING_TYPE_NOT_LIKE == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilNotLik") %></option><%}
						   						if (columnVo.getQryColDataType().equals(QryColumnVo.COLUMN_DATA_NUMBER) || queryVo.isFreeSQL()) {%><option value='<%= IQueryFilter.NUMBER_TYPE_EQUAL %>' validFor="<%= QryColumnVo.COLUMN_DATA_NUMBER %>" <%= (IQueryFilter.NUMBER_TYPE_EQUAL == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilEqu") %></option><option value='<%= IQueryFilter.NUMBER_TYPE_LESS %>' validFor="<%= QryColumnVo.COLUMN_DATA_NUMBER %>" <%= (IQueryFilter.NUMBER_TYPE_LESS == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilLes") %></option><option value='<%= IQueryFilter.NUMBER_TYPE_MORE %>' validFor="<%= QryColumnVo.COLUMN_DATA_NUMBER %>" <%= (IQueryFilter.NUMBER_TYPE_MORE == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilMor") %></option><option value='<%= IQueryFilter.NUMBER_TYPE_DISTINCT %>' validFor="<%= QryColumnVo.COLUMN_DATA_NUMBER %>" <%= (IQueryFilter.NUMBER_TYPE_DISTINCT == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilDis") %></option><option value='<%= IQueryFilter.NUMBER_TYPE_LESS_OR_EQUAL %>' validFor="<%= QryColumnVo.COLUMN_DATA_NUMBER %>" <%= (IQueryFilter.NUMBER_TYPE_LESS_OR_EQUAL == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilLesE") %></option><option value='<%= IQueryFilter.NUMBER_TYPE_MORE_OR_EQUAL %>' validFor="<%= QryColumnVo.COLUMN_DATA_NUMBER %>" <%= (IQueryFilter.NUMBER_TYPE_MORE_OR_EQUAL == filType.intValue())? "selected":"" %>><%= LabelManager.getName(labelSet,"lblFilMorE") %></option><%}%></select></td><td align="center" ><select name="cmbUserReq" ><option value="1" <%= columnVo.getFlagValue(QryColumnVo.FLAG_IS_REQUIERED)?"selected":""%>><%=LabelManager.getName(labelSet,"lblYes")%></option><option value="0" <%= (!columnVo.getFlagValue(QryColumnVo.FLAG_IS_REQUIERED))?"selected":""%>><%=LabelManager.getName(labelSet,"lblNo")%></option></select></td><td align="center" ><select name="cmbColType" id="mbColTypec" <%=(columnVo.getFlagValue(QryColumnVo.FLAG_USER_FILTER_IS_READONLY))?"disabled=\"true\"":((QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL()) ? "style=\"display:none\"" : "")%>><option value="0"><%=LabelManager.getToolTip(labelSet,"lblNo")%></option><option value="1" <%= columnVo.getFlagValue(QryColumnVo.FLAG_IS_COMBO)?"selected":""%>><%=LabelManager.getToolTip(labelSet,"lblYes")%></option><option value="2" <%= columnVo.getFlagValue(QryColumnVo.FLAG_IS_LISTCOMBO)?"selected":""%>><%=LabelManager.getToolTip(labelSet,"lblListbox")%></option></select></td><td align="center" ><input type="checkbox" name="cmbExecOnCha" id="cmbExecOnCha" <%= columnVo.getFlagValue(QryColumnVo.FLAG_EXECUTE_ONCHANGE)?"checked":""%> value="1" ></td><td align="center" ><input type="checkbox" name="cmbUserTime" id="cmbUserTime" <%= columnVo.getFlagValue(QryColumnVo.FLAG_SHOW_TIME)?"checked":""%> value="1" style="<%= (! QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL())?"display:none":"" %>" ></td><td align="center" ><input type="checkbox" name="cmbShow2Column" id="cmbShow2Column" <%= columnVo.getFlagValue(QryColumnVo.FLAG_SHOW_2_COLUMNS)?"checked":""%> value="1" style="<%= (QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL())?"display:none":"" %>" ></td><td align="center" ><input type="checkbox" name="cmbUseUpper" id="cmbUseUpper" <%= columnVo.getFlagValue(QryColumnVo.FLAG_USE_UPPERCASE)?"checked":""%> value="1" style="<%= (QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL())?"display:none":"" %>" ></td><td align="center" ><input type="checkbox" name="cmbIsReadOnly" id="cmbIsReadOnly" <%= columnVo.getFlagValue(QryColumnVo.FLAG_USER_FILTER_IS_READONLY)?"checked":""%> value="1" ></td><td align="left"><% if (QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL()) { %><input type="hidden" name="cmbBusEntIdFilter" value=""><% } else { %><select name="cmbBusEntIdFilter"><option value=""></option><% if (dBean.getBusEntities() != null) {
										   						for (Iterator it = dBean.getBusEntities().iterator(); it.hasNext(); ) {
										   							BusEntityVo busEntVo = (BusEntityVo) it.next(); %><option value="<%= busEntVo.getBusEntId() %>" <% if (busEntVo.getBusEntId().equals(columnVo.getBusEntId())) { %>selected<% } %>><%= busEntVo.getBusEntName() %></option><%
										   						}
										   					} %></select><% } %></td><td align="center" ><input type="checkbox" name="cmbHidFilSel" id="cmbHidFilSel" <%= columnVo.getFlagValue(QryColumnVo.FLAG_HIDDE_FILTER_TYPE_SELECTION)?"checked":""%> value="1" style="<%= (QryColumnVo.COLUMN_DATA_DATE.equals(columnVo.getQryColDataType()) && ! queryVo.isFreeSQL())?"display:none":"" %>" ></td><% if (QueryVo.TYPE_QUERY.equals(queryVo.getQryType())) { %><td align="center"><input type="checkbox" name="cmbFilDontUseAutoFilter" id="cmbFilDontUseAutoFilter" <%= columnVo.getFlagValue(QryColumnVo.FLAG_DONT_USE_AS_AUTOFILTER)?"checked":""%> value="1"></td><%
										   		} %></tr><%
	 	   								}
	  								}%></tbody></table></div><table class="navBar"><tr><td><button type="button" onclick="upWhereUsu_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnUp")%>" title="<%=LabelManager.getToolTip(labelSet,"btnUp")%>"><%=LabelManager.getNameWAccess(labelSet,"btnUp")%></button><button type="button" onclick="downWhereUsu_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnDown")%>" title="<%=LabelManager.getToolTip(labelSet,"btnDown")%>"><%=LabelManager.getNameWAccess(labelSet,"btnDown")%></button><% if (QueryVo.TYPE_MODAL.equals(queryVo.getQryType())){ %><br><input type="checkbox" name="chkFilterOpen" accessKey="<%=LabelManager.getAccessKey(labelSet,"lblQryFilterOpen")%>" <%= (queryVo.getFlagValue(QueryVo.FLAG_FILTER_OPEN))?"checked":"" %> ><%=LabelManager.getNameWAccess(labelSet,"lblQryFilterOpen")%><br><%}%></td><td width="20%" align="left"><% if (!QueryVo.TYPE_MODAL.equals(queryVo.getQryType()) && !QueryVo.TYPE_ENTITY_MODAL.equals(queryVo.getQryType())){ %><input type="checkbox" name="chkForgetUserFilters" accessKey="<%=LabelManager.getAccessKey(labelSet,"lblQryForgetUserFilters")%>" <%= (queryVo.getFlagValue(QueryVo.FLAG_FORGET_USER_FILTERS))?"checked":"" %> ><%=LabelManager.getNameWAccess(labelSet,"lblQryForgetUserFilters")%><%}%></td><td align="right"><%
					   				if (QueryVo.SOURCE_BUS_CLASS.equals(queryVo.getSource())) { %><button type="button" onclick="btnAddUserBusClaPar_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnAgrPar")%>" title="<%=LabelManager.getToolTip(labelSet,"btnAgrPar")%>"><%=LabelManager.getNameWAccess(labelSet,"btnAgrPar")%></button><%
					   				} else if (QueryVo.SOURCE_CONNECTION.equals(queryVo.getSource())) {
						   				if (queryVo.getFlagValue(QueryVo.FLAG_TO_VIEW)) {%><button type="button" onclick="btnAddUser_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnAgrCol")%>" title="<%=LabelManager.getToolTip(labelSet,"btnAgrCol")%>"><%=LabelManager.getNameWAccess(labelSet,"btnAgrCol")%></button><%
							   				if (false && queryVo.getFlagValue(QueryVo.FLAG_ALLOW_ATTRIBUTE)) {%><button type="button" onclick="btnAddUserAtt_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnAgrAtt")%>" title="<%=LabelManager.getToolTip(labelSet,"btnAgrAtt")%>"><%=LabelManager.getNameWAccess(labelSet,"btnAgrAtt")%></button><%}%><%
							   			} else {%><button type="button" onclick="btnAddUserPar_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnAgrPar")%>" title="<%=LabelManager.getToolTip(labelSet,"btnAgrPar")%>"><%=LabelManager.getNameWAccess(labelSet,"btnAgrPar")%></button><%
						   				}
						   			} %><button type="button" onclick="btnDelUser_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnEli")%>" title="<%=LabelManager.getToolTip(labelSet,"btnEli")%>"><%=LabelManager.getNameWAccess(labelSet,"btnEli")%></button></td></tr></table></div>
