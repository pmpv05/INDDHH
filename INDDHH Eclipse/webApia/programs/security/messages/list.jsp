<%@page import="com.dogma.vo.*"%><%@page import="com.dogma.vo.filter.*"%><%@page import="java.util.*"%><%@page import="com.dogma.util.DogmaUtil"%><%@include file="../../../components/scripts/server/startInc.jsp" %><% boolean canOrderBy = false; %><HTML><head><%@include file="../../../components/scripts/server/headInclude.jsp" %></head><body><jsp:useBean id="dBean" scope="session" class="com.dogma.bean.security.MessageBean"></jsp:useBean><TABLE class="pageTop"><COL class="col1"><COL class="col2"><TR><TD><%=LabelManager.getName(labelSet,dBean.isModeGlobal()?"titMen":"titMenEnv")%></TD><TD></TD></TR></TABLE><DIV id="divContent" class="divContent"><form id="frmMain" name="frmMain" method="POST"><DIV class="subTit"><table width="100%"><tr class="subTit"><td width="100%" align="left"><%=LabelManager.getName(labelSet,"sbtFil")%></td><td align="right"><button type="button" id="toggleFilter" title="<%=LabelManager.getToolTip(labelSet,"lblMonButFil")%>" class="btn" onclick="toggleFilterSection(<%=Parameters.SCREEN_LIST_SIZE - Parameters.FILTER_LIST_SIZE%>,<%=(Parameters.SCREEN_LIST_SIZE)%>)"><img src="<%=Parameters.ROOT_PATH%>/styles/<%= styleDirectory %>/images/openToc.gif" width="8" height="7"></button></td></tr></table></DIV><DIV id="listFilterArea" style="display:none"><DIV style="OVERFLOW:AUTO;HEIGHT:<%= Parameters.FILTER_LIST_SIZE - 32 %>px;"><table class="tblFormLayout"><COL class="col1"><COL class="col2"><COL class="col3"><COL class="col4"><tr><td title="<%=LabelManager.getToolTip(labelSet,"lblFecDes")%>"><%=LabelManager.getNameWAccess(labelSet,"lblFecDes")%>:</td><td><input name="dteFrom" class="txtDate" size="10" p_mask = "<%=DogmaUtil.getHTMLDateMask(dBean.getEnvId(request))%>" p_calendar="true" maxlength="10" type="text" value="<%=dBean.fmtDate(dBean.getFilter().getDateFrom())%>" accesskey="<%=LabelManager.getAccessKey(labelSet,"lblFecDes")%>"></td><td title="<%=LabelManager.getToolTip(labelSet,"lblFecHas")%>"><%=LabelManager.getNameWAccess(labelSet,"lblFecHas")%>:</td><td><input name="dteTo" class="txtDate" size="10" p_mask = "<%=DogmaUtil.getHTMLDateMask(dBean.getEnvId(request))%>" p_calendar="true" maxlength="10" type="text" value="<%=dBean.fmtDate(dBean.getFilter().getDateTo())%>" accesskey="<%=LabelManager.getAccessKey(labelSet,"lblFecHas")%>"></td></tr><tr><% 
		   				if (dBean.isModeGlobal()) { %><td title="<%=LabelManager.getToolTip(labelSet,"lblAmb")%>"><%=LabelManager.getNameWAccess(labelSet,"lblAmb")%>:</td><td><select name="cmbEnvId" accesskey="<%=LabelManager.getAccessKey(labelSet,"lblAmb")%>"><option value="" <%= (dBean.getFilter().getEnvId() == null)?"selected":""%>></option><%
			   					Collection envs = dBean.getAllEnvs();
			   					if (envs != null && envs.size() > 0) {
				   					Iterator iterator = envs.iterator();
				   					while (iterator.hasNext()) {
					   					EnvironmentVo env = (EnvironmentVo) iterator.next(); %><option value="<%=dBean.fmtInt(env.getEnvId()) %>" <%= (env.getEnvId().equals(dBean.getFilter().getEnvId()))?"selected":""%>><%=dBean.fmtStr(env.getEnvName())%></option><%
					   				}
				   				}
			   				%></select></td><%
			   			} else { %><td></td><td></td><%
						} %><td title="<%=LabelManager.getToolTip(labelSet,"lblTexMen")%>"><%=LabelManager.getNameWAccess(labelSet,"lblTexMen")%>:</td><td><input name="txtMsg" maxlength="50" type="text" accesskey="<%=LabelManager.getAccessKey(labelSet,"lblTexMen")%>" value="<%=dBean.fmtStr(dBean.getFilter().getMessage())%>"></td></tr></table></div><table class="tblFormLayout"><COL class="col1"><COL class="col2"><COL class="col3"><COL class="col4"><tr><td></td><td colspan=3 align="right"><button type="button" onclick="btnSearch_click()" title="<%=LabelManager.getToolTip(labelSet,"btnBus")%>" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnBus")%>"><%=LabelManager.getNameWAccess(labelSet,"btnBus")%></button></td></tr></table></DIV><!--     ---------------------------------------------               --><DIV class="subTit"><%=LabelManager.getName(labelSet,"sbtRes")%></DIV><div type="grid" id="gridList" style="height:<%=Parameters.SCREEN_LIST_SIZE%>px"><table cellpadding="0" cellspacing="0"><thead><tr><th style="width:0px;display:none;" title="<%=LabelManager.getToolTip(labelSet,"lblSel")%>"></td><%if(dBean.isModeGlobal()){%><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_ENVIRONMENT; %><th min_width="80px" style="width:80px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_ENVIRONMENT%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblAmb")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblAmb")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_DATE_START; %><th min_width="70px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_DATE_START%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblFecDes")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblFecDes")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_DATE_END; %><th min_width="70px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_DATE_END%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblFecHas")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblFecHas")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_MESSAGE; %><th min_width="150px" style="min-width:150px;width:100%<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_MESSAGE%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblTexMen")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblTexMen")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_USER; %><th min_width="70px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_USER%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLastUsrName")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLastUsrName")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_DATE; %><th min_width="70px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_DATE%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLastActDate")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLastActDate")%><%=canOrderBy?"</u>":""%></th><%}else{%><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_DATE_START; %><th min_width="70px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_DATE_START%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblFecDes")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblFecDes")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_DATE_END; %><th min_width="70px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_DATE_END%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblFecHas")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblFecHas")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_MESSAGE; %><th min_width="150px" style="min-width:150px;width:100%<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_MESSAGE%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblTexMen")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblTexMen")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_USER; %><th min_width="80px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_USER%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLastUsrName")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLastUsrName")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != MessageFilterVo.ORDER_DATE; %><th min_width="80px" style="width:70px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=MessageFilterVo.ORDER_DATE%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLastActDate")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLastActDate")%><%=canOrderBy?"</u>":""%></th><%}%></tr></thead><tbody><%	Collection col = dBean.getList();
							if (col != null) {
								Iterator it = col.iterator();
								int i = 0;
								EnvMessageVo mVO = null;
								while (it.hasNext()) {
									mVO = (EnvMessageVo) it.next(); %><tr><td style="width:0px;display:none;"><input type="hidden" id="idSel" name="chkSel<%=i%>"><input type="hidden" name="hidEnvId<%=i%>" value="<%=dBean.fmtInt(mVO.getEnvId())%>"><input type="hidden" name="hidMsgId<%=i%>" value="<%=dBean.fmtInt(mVO.getEnvMsgId())%>"></td><%if(dBean.isModeGlobal()){%><td><%=dBean.fmtHTML(dBean.getEnvName(mVO.getEnvId()))%></td><%}%><td><%=dBean.fmtHTML(mVO.getEnvMsgDateFrom())%></td><td><%=dBean.fmtHTML(mVO.getEnvMsgDateTo())%></td><%String strText = mVO.getEnvMsgText();
										if(strText!=null && strText.length() > 30) {
											strText = strText.substring(0,29) + " ... ";
										}%><td style="min-width:150px" title="<%=dBean.fmtHTML(mVO.getEnvMsgText())%>"><%=dBean.fmtHTML(strText)%></td><td><%=dBean.fmtHTML(mVO.getRegUser())%></td><td><%=dBean.fmtHTML(mVO.getRegDate())%></td></tr><%i++;%><%}
							}%></tbody></table></div><table class="navBar"><COL class="col1"><COL class="col2"><tr><%@include file="../../includes/navButtons.jsp" %><td><button type="button" onclick="btnNew_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnCre")%>" title="<%=LabelManager.getToolTip(labelSet,"btnCre")%>"><%=LabelManager.getNameWAccess(labelSet,"btnCre")%></button><button type="button" onclick="btnMod_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnMod")%>" title="<%=LabelManager.getToolTip(labelSet,"btnMod")%>"><%=LabelManager.getNameWAccess(labelSet,"btnMod")%></button><button type="button" onclick="btnDel_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnEli")%>" title="<%=LabelManager.getToolTip(labelSet,"btnEli")%>"><%=LabelManager.getNameWAccess(labelSet,"btnEli")%></button><button type="button" onclick="btnIni_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnIniMsg")%>" title="<%=LabelManager.getToolTip(labelSet,"btnIniMsg")%>"><%=LabelManager.getNameWAccess(labelSet,"btnIniMsg")%></button></td></tr></table></form></div><TABLE class="pageBottom"><COL class="col1"><COL class="col2"><TR><TD></TD><TD><button type="button" onclick="splash()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnSal")%>" title="<%=LabelManager.getToolTip(labelSet,"btnSal")%>"><%=LabelManager.getNameWAccess(labelSet,"btnSal")%></button></TD></TR></TABLE></body></html><%@include file="../../../components/scripts/server/endInc.jsp" %><script language="javascript" src='<%=Parameters.ROOT_PATH%>/programs/security/messages/list.js'></script>