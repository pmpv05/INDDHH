<%@page import="com.dogma.vo.*"%><%@page import="com.dogma.vo.filter.*"%><%@page import="java.util.*"%><%@include file="../../../components/scripts/server/startInc.jsp" %><% boolean canOrderBy = false; %><HTML><head><%@include file="../../../components/scripts/server/headInclude.jsp" %></head><body><jsp:useBean id="dBean" scope="session" class="com.dogma.bean.security.UserSubstituteBean"></jsp:useBean><TABLE class="pageTop"><COL class="col1"><COL class="col2"><TR><TD><%if(dBean.isFromHierarchy()){ %><%=LabelManager.getName(labelSet,"titLeaveHier")%><%}else{ %><%=LabelManager.getName(labelSet,"titLeave")%><%} %></TD><TD></TD></TR></TABLE><DIV id="divContent" class="divContent"><form id="frmMain" name="frmMain" method="POST"><DIV class="subTit"><table width="100%"><tr class="subTit"><td width="100%" align="left"><%=LabelManager.getName(labelSet,"sbtFil")%></td><td align="right"><button type="button" id="toggleFilter" title="<%=LabelManager.getToolTip(labelSet,"lblMonButFil")%>" class="btn" onclick="toggleFilterSection(<%=Parameters.SCREEN_LIST_SIZE - Parameters.FILTER_LIST_SIZE%>,<%=(Parameters.SCREEN_LIST_SIZE)%>)"><img src="<%=Parameters.ROOT_PATH%>/styles/<%= styleDirectory %>/images/openToc.gif" width="8" height="7"></button></td></tr></table></DIV><DIV id="listFilterArea" style="display:none"><DIV style="OVERFLOW:AUTO;HEIGHT:<%= Parameters.FILTER_LIST_SIZE - 32 %>px;"><table class="tblFormLayout"><colgroup><COL class="col1"><COL class="col2"><COL class="col3"><COL class="col4"></colgroup><tbody><tr><td title="<%=LabelManager.getToolTip(labelSet,"lblLog")%>"><%=LabelManager.getNameWAccess(labelSet,"lblLog")%>:</td><td><input name="txtLogin" maxlength="50" type="text" value="<%=dBean.fmtStr(dBean.getFilter().getLogin())%>" accesskey="<%=LabelManager.getAccessKey(labelSet,"lblLog")%>"></td><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></div><table class="tblFormLayout"><COL class="col1"><COL class="col2"><COL class="col3"><COL class="col4"><tr><td></td><td colspan=3 align="right"><button type="button" onclick="btnSearch_click()" title="<%=LabelManager.getToolTip(labelSet,"btnBus")%>" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnBus")%>"><%=LabelManager.getNameWAccess(labelSet,"btnBus")%></button></td></tr></table></DIV><!--     ---------------------------------------------               --><DIV class="subTit"><%=LabelManager.getName(labelSet,"sbtRes")%></DIV><div type="grid" id="gridList" style="height:<%=Parameters.SCREEN_LIST_SIZE%>px"><table width="500px" cellpadding="0" cellspacing="0"><thead><tr><th style="width:0px;display:none;" title="<%=LabelManager.getToolTip(labelSet,"lblSel")%>"></th><% canOrderBy = dBean.getFilter().getOrderBy() != UserSubstituteFilterVo.ORDER_LOGIN; %><th min_width="80px" style="min-width:80px;width:20%<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=UserSubstituteFilterVo.ORDER_LOGIN%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLog")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLog")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != UserSubstituteFilterVo.ORDER_DTE_FROM; %><th min_width="100px" style="min-width:100px;width:40%<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=UserSubstituteFilterVo.ORDER_DTE_FROM%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblDteFrom")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblDteFrom")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != UserSubstituteFilterVo.ORDER_DTE_TO; %><th min_width="100px" style="min-width:100px;width:40%<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=UserSubstituteFilterVo.ORDER_DTE_TO%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblDteTo")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblDteTo")%><%=canOrderBy?"</u>":""%></th><th min_width="80px" style="width:80px" title="<%=LabelManager.getToolTip(labelSet,"lblSta")%>"><%=LabelManager.getName(labelSet,"lblSta")%></th><% canOrderBy = dBean.getFilter().getOrderBy() != UserSubstituteFilterVo.ORDER_USER; %><th min_width="80px" style="width:80px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=UserSubstituteFilterVo.ORDER_USER%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLastUsrName")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLastUsrName")%><%=canOrderBy?"</u>":""%></th><% canOrderBy = dBean.getFilter().getOrderBy() != UserSubstituteFilterVo.ORDER_DATE; %><th min_width="80px" style="width:80px<% if (canOrderBy) {%>;cursor:hand" onclick="orderBy('<%=UserSubstituteFilterVo.ORDER_DATE%>')<%}%>" title="<%=LabelManager.getToolTip(labelSet,"lblLastActDate")%>"><%=canOrderBy?"<u>":""%><%=LabelManager.getName(labelSet,"lblLastActDate")%><%=canOrderBy?"</u>":""%></th></tr></thead><tbody><%	Collection col = dBean.getList();
							if (col != null) {
								Iterator it = col.iterator();
								int i = 0;
								UsersSubstitutesVo uVO = null;
								while (it.hasNext()) {
									uVO = (UsersSubstitutesVo) it.next(); %><tr><td style="width:0px;display:none;"><input type="hidden" id="idSel" name="chkSel<%=i%>"><input type="hidden" name="hidUserId<%=i%>" value="<%=dBean.fmtStr(uVO.getUsrLogin())%>"><input type="hidden" name="hidDteFrom<%=i%>" value="<%=com.dogma.util.DogmaUtil.dateToString(dBean.getEnvId(request), uVO.getStartDate())%>"><input type="hidden" name="hidDteTo<%=i%>" value="<%=com.dogma.util.DogmaUtil.dateToString(dBean.getEnvId(request), uVO.getEndDate())%>"></td><td style="min-width:80px"><%=dBean.fmtHTML(uVO.getUsrLogin())%></td><td style="min-width:100px"><%=com.dogma.util.DogmaUtil.dateToString(dBean.getEnvId(request), uVO.getStartDate())%></td><td style="min-width:100px"><%String endDate = com.dogma.util.DogmaUtil.dateToString(dBean.getEnvId(request), uVO.getEndDate());
											if(endDate.indexOf("2100") < 0){
												out.print(endDate);
											}
											%></td><td><%if(uVO.getStartDate().compareTo(new Date())<=0 && uVO.getEndDate().compareTo(new Date())>=0){%><%=LabelManager.getToolTip(labelSet,"lblSupAct")%><%}else{%><%=LabelManager.getToolTip(labelSet,"lblSupNoAct")%><%}%></td><td><%=dBean.fmtHTML(uVO.getRegUser())%></td><td><%=com.dogma.util.DogmaUtil.dateToString(dBean.getEnvId(request), uVO.getRegDate())%></td></tr><%i++;%><%	}
							}%></tbody></table></div><table class="navBar"><COL class="col1"><COL class="col2"><tr><%@include file="../../includes/navButtons.jsp" %><td><button type="button" onclick="btnHistory_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnHis")%>" title="<%=LabelManager.getToolTip(labelSet,"btnHis")%>"><%=LabelManager.getNameWAccess(labelSet,"btnHis")%></button><button type="button" onclick="btnNew_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnCre")%>" title="<%=LabelManager.getToolTip(labelSet,"btnCre")%>"><%=LabelManager.getNameWAccess(labelSet,"btnCre")%></button><button type="button" onclick="btnDel_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnEli")%>" title="<%=LabelManager.getToolTip(labelSet,"btnEli")%>"><%=LabelManager.getNameWAccess(labelSet,"btnEli")%></button><button type="button" onclick="btnView_click()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnMod")%>" title="<%=LabelManager.getToolTip(labelSet,"btnMod")%>"><%=LabelManager.getNameWAccess(labelSet,"btnMod")%></button></td></tr></table></form></div><TABLE class="pageBottom"><COL class="col1"><COL class="col2"><TR><TD></TD><TD><button type="button" onclick="splash()" accesskey="<%=LabelManager.getAccessKey(labelSet,"btnSal")%>" title="<%=LabelManager.getToolTip(labelSet,"btnSal")%>"><%=LabelManager.getNameWAccess(labelSet,"btnSal")%></button></TD></TR></TABLE></body></html><%@include file="../../../components/scripts/server/endInc.jsp" %><script language="javascript"  src='<%=Parameters.ROOT_PATH%>/programs/security/usersSubstitutes/list.js'></script>