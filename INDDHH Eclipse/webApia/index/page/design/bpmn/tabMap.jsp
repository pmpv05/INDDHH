<%@page import="com.dogma.Parameters"%><%
	String tabId = "&tabId=" + request.getParameter("tabId") + "&tokenId=" + uData.getTokenId();
%><script>
	window.addEvent("domready", function() {
		$("tabMap").addEvent("click", function() {
			$("aMapTab").setStyle("height", "100%");
		}).addEvent("custom_blur", function() {
			$("aMapTab").setStyle("height", "auto");
		});
	});
</script><div class="aTab" id="aMapTab"><div class="tab" id="tabMap"><system:label show="text" label="tabProMap" /></div><div class="contentTab" id="contentTabMap" style="height: 100%;" ><div id="pDesignerContainer" style="width: 100%; height: 100%;"><!-- INICIO: PROCESOS BPMN --><system:edit show="ifValue" from="theEdition" field="isBpmn" value="1"><!-- INICIO: CREAR, MODIFICAR, VERSIONES --><system:edit show="ifValue" from="theBean" field="modeDebug" value="false"><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="Designer" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" WIDTH="100%" HEIGHT="100%" ALIGN="center" VALIGN="middle"><param name="allowScriptAccess" value="allways" /><param name="movie" value="<system:util show="context" />/flash/BPMN/Designer.swf" /><param name="FlashVars" value="taskFrmDocUrlExtraParams=tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&inApia=true&elementAtts=<system:util show="context" />/flash/BPMN/elementAttributes.jsp?tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&bgColor=0xffffff&langId=<%=uData.getLangId()%>&urlBase=<system:util show="context" />/flash/BPMN/&taskFrmDocUrl="/><param name="quality" value="high" /><param name="menu" value="false" /><param name="bgcolor" value="#EFEFEF" /><param name="WMODE" value="transparent" /><embed style="height: 100%;" wmode="transparent" id="Designer" name="Designer" menu="false" allowScriptAccess="allways" src="<system:util show="context" />/flash/BPMN/Designer.swf" flashVars="taskFrmDocUrlExtraParams=tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&inApia=true&elementAtts=<system:util show="context" />/flash/BPMN/elementAttributes.jsp?tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&bgColor=0xffffff&langId=<%=uData.getLangId()%>&urlBase=<system:util show="context" />/flash/BPMN/&taskFrmDocUrl=" quality="high" bgcolor="#efefef" width="100%" height="600" swLiveConnect="true"   align="middle" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" /></object></system:edit><!-- FIN: CREAR, MODIFICAR, VERSIONES --><!-- INICIO: DEBUG --><system:edit show="ifValue" from="theBean" field="modeDebug" value="true"><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"  id="Designer" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" WIDTH="100%" HEIGHT="100%" ALIGN="center" VALIGN="middle"><param name="allowScriptAccess" value="allways" /><param name="movie" value="<system:util show="context" />/flash/BPMN/Debugger.swf" /><param name="FlashVars" value="inApia=true&elementAtts=<system:util show="context" />/flash/BPMN/elementAttributes.jsp?tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&urlBase=<system:util show="context" />/flash/BPMN/&debuggerUrl=<system:util show="context" />/apia.design.BPMNProcessAction.run?action=debuggerXml%26tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&executeUrl=<system:util show="context" />/apia.design.BPMNProcessAction.run?action=debuggerExecute%26tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&groupsUrl=<system:util show="context" />/apia.design.BPMNProcessAction.run?type=group%26tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />"/><param name="quality" value="high" /><param name="menu" value="false"><param name="bgcolor" value="#EFEFEF" /><param name="WMODE" value="transparent" /><embed style="height: 100%;" wmode="transparent" id="Designer" name="Designer" menu="false" allowScriptAccess="allways" src="<system:util show="context" />/flash/BPMN/Debugger.swf" flashVars="inApia=true&elementAtts=<system:util show="context" />/flash/BPMN/elementAttributes.jsp?tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&urlBase=<system:util show="context" />/flash/BPMN/&debuggerUrl=<system:util show="context" />/apia.design.BPMNProcessAction.run?action=debuggerXml%26tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&executeUrl=<system:util show="context" />/apia.design.BPMNProcessAction.run?action=debuggerExecute%26tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />&groupsUrl=<system:util show="context" />/apia.design.BPMNProcessAction.run?type=group%26tabId=<system:util show="tabId" />%26tokenId=<system:util show="tokenId" />" quality="high" bgcolor="#efefef" width="100%" height="600" swLiveConnect="true"   align="middle" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" /></object></object></system:edit><!-- FIN: DEBUG --></system:edit><!-- FIN: PROCESOS BPMN --><!-- INICIO: PROCESOS --><system:edit show="ifNotValue" from="theEdition" field="isBpmn" value="1"><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"  
				 		codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" 
						WIDTH="100%" 
						HEIGHT="500px" 
						id="shell" ALIGN="center" VALIGN="middle"><param name="allowScriptAccess" value="sameDomain" /><param name="movie" value="<system:util show="context" />/flash/process/deploy/shell.swf" /><param name="FlashVars" value="utf=<%="UTF-8".equals(Parameters.APP_ENCODING)%>&IN_APIA=true&SWF_OBJ_PATH=<system:util show="context" />/flash/process/deploy/<%=tabId%>"/><param name="quality" value="high" /><param name="menu" value="false"><param name="bgcolor" value="#EFEFEF" /><param name="WMODE" value="transparent" /><embed wmode="transparent" menu="false" allowScriptAccess="sameDomain" src="<system:util show="context" />/flash/process/deploy/shell.swf" quality="high" bgcolor="#efefef" width="100%" height="450" swLiveConnect="true" id="shell" name="shell" align="middle" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashVars="utf=<%="UTF-8".equals(Parameters.APP_ENCODING)%>&IN_APIA=true&SWF_OBJ_PATH=<system:util show="context" />/flash/process/deploy/<%=tabId%>" /></object><!-- FLASH PARA IMPRESION --><div id="imageGenerator" style="position:absolute;top=1;left=0;width:1px;height:1px;overflow:hidden"><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"  
							codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" 
							WIDTH="100%" 
							HEIGHT="500px" 
							style="/*border:1px solid blue*/"
							id="shellPrint" ALIGN="center" VALIGN="middle"><param name="allowScriptAccess" value="sameDomain" /><param name="movie" value="<system:util show="context" />/flash/process/deploy/shell.swf" /><param name="FlashVars" value="toPrint=true&utf=<%="UTF-8".equals(Parameters.APP_ENCODING)%>&IN_APIA=true&SWF_OBJ_PATH=<system:util show="context" />/flash/process/deploy/<%=tabId%>"/><param name="quality" value="high" /><param name="menu" value="false"><param name="bgcolor" value="#EFEFEF" /><param name="WMODE" value="transparent" /><embed wmode="transparent" menu="false" allowScriptAccess="sameDomain" src="<system:util show="context" />/flash/process/deploy/shell.swf" quality="high" bgcolor="#efefef" width="100%" height="450" swLiveConnect="true" id="shellPrint" name="shellPrint" align="middle" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashVars="toPrint=true&utf=<%="UTF-8".equals(Parameters.APP_ENCODING)%>&IN_APIA=true&SWF_OBJ_PATH=<system:util show="context" />/flash/process/deploy/<%=tabId%>" /></object><input id="prntAction" name="action"/><input id="prntTabId" name="tabId"/><input id="prntTokenId" name="tokenId"/></div></system:edit><!-- FIN: PROCESOS --><!-- INICIO: GENERAL PARA AMBOS CASOS --><div width=100% style="display: none;"><%  if (!proVo.getProDefinitionXml().contains("&amp;")) {
						String tmpMap = StringUtil.replace(proVo.getProDefinitionXml(),"&","&amp;");
						if (tmpMap.contains("&amp;amp;")) {
							tmpMap = StringUtil.replace(proVo.getProDefinitionXml(),"&amp;amp;","&amp;");
						}%><TEXTAREA p_required="true"  id="txtMap" name="txtMap" cols="100" rows="30"><%=tmpMap%></TEXTAREA><% } else { %><TEXTAREA p_required="true"  id="txtMap" name="txtMap" cols="100" rows="30"><%=proVo.getProDefinitionXml()%></TEXTAREA><% } %></div><!-- FIN: GENERAL PARA AMBOS CASOS --></div></div></div>