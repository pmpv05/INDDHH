<!-- saved from url=(0013)about:internet --><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>treeDrop</title></head><body bgcolor="#ffffff"><script language="JavaScript"><!--
var isInternetExplorer = navigator.appName.indexOf("Microsoft") != -1;
// Handle all the FSCommand messages in a Flash movie.
function treeDrop_DoFSCommand(command, args) {
	var treeDropObj = isInternetExplorer ? document.all.treeDrop : document.treeDrop;
	//
	// Place your code here.
	//
	if(command=="getTables"){
		setTables();
	}else if(command=="getPrimaries"){
		var par1=args.split(".")[0];
		var par2=args.split(".")[1];
		setPrimaries(par1,par2);
	}else if(command=="getSharedDimensions"){
		setSharedDimensions();
	}else if(command=="getColumns"){
		setColumns();
	}else if(command=="loadDimensionProps"){
		setDimensionProps();
	}else if(command=="outputXML"){
		after(args);
	}else if(command=="loadHierarchyTableProps"){
		setHierarchyTableProps();
	}else{
		alert(command+"--"+args);
	}
}
// Hook for Internet Explorer.
if (navigator.appName && navigator.appName.indexOf("Microsoft") != -1 && navigator.userAgent.indexOf("Windows") != -1 && navigator.userAgent.indexOf("Windows 3.1") == -1) {
	document.write('<script language=\"VBScript\"\>\n');
	document.write('On Error Resume Next\n');
	document.write('Sub treeDrop_FSCommand(ByVal command, ByVal args)\n');
	document.write('	Call treeDrop_DoFSCommand(command, args)\n');
	document.write('End Sub\n');
	document.write('</script\>\n');
}
//--></script><script language="javascript">

	var after=function(){}


	function setTables(){
		var tables="tableid-tabla1;tableid-tablaZ;tableid-tabla9;tableid-tabla3;tableid-tabla7;tableid-tabla4";
		getFlashObject("treeDrop").SetVariable("call", "setTables,"+tables);
	}


	function setPrimaries(tableId,tableName){
		var primaries="colid-primary1;colid-primary2;colid-primary3;colid-primary4";
		getFlashObject("treeDrop").SetVariable("call", "setPrimaries,"+primaries);
	}

	function setColumns(){
		var columns="primary1.aaa-bbb.aaaa;primary2.aaa-bbb.aaaa;primary3.aaa-bbb.aaaa;primary4.aaa-bbb.aaaa";
		getFlashObject("treeDrop").SetVariable("call", "setColumns,"+columns);
	}


	function setSharedDimensions(){
		var columns="primary1aaa-bbb.aaaa;primary2.aaa-bbb.aaaa;primary3.aaa-bbb.aaaa;primary4.aaa-bbb.aaaa";
		getFlashObject("treeDrop").SetVariable("call", "setSharedDimensions,"+columns);
	}

	function setDimensionProps(){
		var primaries="colid-primary1;colid-primary2;colid-primary3;colid-primary4";
		getFlashObject("treeDrop").SetVariable("call", "setDimensionProps,"+primaries);
	}
	function setHierarchyTableProps(){
		var tables="tableid-tabla1;tableid-tableZ;tableid-tabla9;tableid-table3;tableid-table7;tableid-table4";
		getFlashObject("treeDrop").SetVariable("call", "setHierarchyTableProps,"+tables);
	}


	function getFlashObject(movieName){
		if (window.document[movieName]){
			return window.document[movieName];
		}
		if (navigator.appName.indexOf("Microsoft Internet")==-1){
			if (document.embeds && document.embeds[movieName]){
				return document.embeds[movieName];
			}
		}else{ // if (navigator.appName.indexOf("Microsoft Internet")!=-1){
			return document.getElementById(movieName);
		}
	}

	var model="";

	function saveModel(){
		getFlashObject("treeDrop").SetVariable("call", "getOutputXML");
		after=function(args){
alert(args);
			model=args;
		}
	}

	function loadModel(){
		var modelo='<nodes><node label="CUSTOMER" name="CUSTOMER" foreignKey="F_SALES.CUST_ID" shared="" local="true" el_type="dimension"><node el_type="hierarchy" name="CUSTOMER" label="CUSTOMER" primaryKey="D_CUSTOMER.CUST_ID" primaryKeyTable="" table="" hasAll="true" allMemberName=""><node el_type="field" name="CUST_NAME" level="true" label="CUST_NAME" ordinalColumn="" levelType="Regular" hideMemberIf="Never" uniqueMembers="" type="" column="D_CUSTOMER.CUST_NAME"/></node></node><node label="PRODUCT" name="PRODUCT" foreignKey="F_SALES.PROD_ID" shared="" local="true" el_type="dimension"><node el_type="hierarchy" name="PRODUCT" label="PRODUCT" primaryKey="D_PRODUCT.PROD_ID" primaryKeyTable="" table="" hasAll="true" allMemberName=""><node el_type="field" name="PROD_TEXT" level="true" label="PROD_TEXT" ordinalColumn="" levelType="Regular" hideMemberIf="Never" uniqueMembers="" type="" column="D_PRODUCT.PROD_TEXT"/></node></node><node label="TIME" name="TIME" foreignKey="F_SALES.DATE_ID" shared="" local="true" el_type="dimension"><node el_type="hierarchy" name="TIME" label="TIME" primaryKey="D_TIME.DATE_ID" primaryKeyTable="" table="" hasAll="true" allMemberName=""><node el_type="field" name="YEAR_ID" level="true" label="YEAR_ID" ordinalColumn="" levelType="Regular" hideMemberIf="Never" uniqueMembers="" type="" column="D_TIME.YEAR_ID"/><node el_type="field" name="QUARTER_ID" level="true" label="QUARTER_ID" ordinalColumn="" levelType="Regular" hideMemberIf="Never" uniqueMembers="" type="" column="D_TIME.QUARTER_ID"/><node el_type="field" name="MONTH_ID" level="true" label="MONTH_ID" ordinalColumn="" levelType="Regular" hideMemberIf="Never" uniqueMembers="" type="" column="D_TIME.MONTH_ID"/></node></node></nodes>';
		getFlashObject("treeDrop").SetVariable("call", ("loadXML,"+model));
		getFlashObject("treeDrop").SetVariable("call", ("loadXML,"+modelo));
	}

	
</script><!--url's used in the movie--><!--text used in the movie--><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" id="treeDrop" width="100%" height="100%" align="middle"><param name="allowScriptAccess" value="sameDomain" /><param name="movie" value="treeDrop.swf" /><param name="quality" value="high" /><param name="bgcolor" value="#ffffff" /><param name="flashVars" value="labels=labels.txt" /><embed src="treeDrop.swf" flashVars="labels=labels.txt" quality="high" bgcolor="#ffffff" width="100%" height="100%" swLiveConnect=true id="treeDrop" name="treeDrop" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" /></object><button type="button" onclick="loadModel()">load model</button><button type="button" onclick="saveModel()">save model</button></body></html>
