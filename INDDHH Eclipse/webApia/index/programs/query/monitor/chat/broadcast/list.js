function checkAllUserClick(checkbox) { document.getElementById("btnAddUser").disabled = checkbox.checked; }
function checkAllPoolClick(checkbox) { document.getElementById("btnAddPool").disabled = checkbox.checked; }

function btnAddUser_click(){
	var rets = openModal("/programs/modals/users.jsp",500,300);
	var doAfter=function(rets){
		if(rets != null) {
			for (j = 0; j < rets.length; j++) {
				var ret = rets[j];
				var addRet = true;
				trows=document.getElementById("gridMsgTo").rows;
				for (i=0;i<trows.length && addRet;i++) {
					if (trows[i].getElementsByTagName("TD")[0].getElementsByTagName("INPUT")[2].value == ret[0]
						&& trows[i].getElementsByTagName("TD")[0].getElementsByTagName("INPUT")[3].value == 'U') {
						addRet = false;
					}
				}
				
				if (addRet) {
					var oTd0 = document.createElement("TD");
					var oTd1 = document.createElement("TD");
					var oTd2 = document.createElement("TD"); 
					var oTd3 = document.createElement("TD"); 
					
					oTd0.innerHTML = "<input type='checkbox' name='chkPoolSel'><input type='hidden' name='chkPool'><input type='hidden' name='usrLogin'><input type='hidden' name='type' value='U'>";
					oTd0.getElementsByTagName("INPUT")[1].value = ret[0];
					oTd0.getElementsByTagName("INPUT")[2].value = ret[0];
					oTd0.align="center";
					
					oTd1.innerHTML = LBL_TYPE_USER;
					oTd2.innerHTML = ret[0];			
					
					oTd3.innerHTML = ret[1];
					//oTd3.style="max-width:100px"
					var oTr = document.createElement("TR");
					oTr.appendChild(oTd0);
					oTr.appendChild(oTd1);
					oTr.appendChild(oTd2);
					oTr.appendChild(oTd3);
					document.getElementById("gridMsgTo").addRow(oTr);
				}
			}
		}
	}
	rets.onclose=function(){
		doAfter(rets.returnValue);
	}
}

function btnAddPool_click() {
	var rets = null;
	rets = openModal("/programs/modals/pools.jsp?showAutogenerated=true&showGlobal=true&"+windowId,500,350);
	
	var doLoad=function(rets){
		if (rets != null) {
			if (rets != null) {
				for (j = 0; j < rets.length; j++) {
					var ret = rets[j];
					var addRet = true;
					trows=document.getElementById("gridMsgTo").rows;
					for (i=0;i<trows.length && addRet;i++) {
						if (trows[i].getElementsByTagName("TD")[0].getElementsByTagName("INPUT")[2].value == ret[0]
							&& trows[i].getElementsByTagName("TD")[0].getElementsByTagName("INPUT")[3].value == 'P') {
							addRet = false;
						}
					}
					
					if (addRet) {
						var oTd0 = document.createElement("TD");
						var oTd1 = document.createElement("TD");
						var oTd2 = document.createElement("TD"); 
						var oTd3 = document.createElement("TD"); 
						
						oTd0.innerHTML = "<input type='checkbox' name='chkPoolSel'><input type='hidden' name='chkPool'><input type='hidden' name='poolName'><input type='hidden' name='type' value='P'>";
						oTd0.getElementsByTagName("INPUT")[1].value = ret[0];
						oTd0.getElementsByTagName("INPUT")[2].value = ret[1];
						oTd0.align="center";
						
						oTd1.innerHTML = LBL_TYPE_POOL;
						
						if(ret[2]==1){
							oTd2.innerHTML = "<B>"+ret[1]+"</B>";			
						} else {
							oTd2.innerHTML = ret[1];			
						}
						
						oTd3.innerHTML = ret[4];		
						var oTr = document.createElement("TR");
						oTr.appendChild(oTd0);
						oTr.appendChild(oTd1);
						oTr.appendChild(oTd2);
						oTr.appendChild(oTd3);
						document.getElementById("gridMsgTo").addRow(oTr);
					}
				}
			}
		}
	}
	rets.onclose=function(){
		doLoad(rets.returnValue);
	}
}

function btnConf_click(){
	if (verifyRequiredObjects()) {
		if (document.getElementById("gridMsgTo").rows.length == 0 && ! document.getElementById("sendAllUsers").checked && ! document.getElementById("sendAllPools").checked) {
			alert(MSG_SELECT_ONE_DESTINATARY);
		} else if (document.getElementById("msg").value == "") {
			alert(MSG_TO_SEND_NOT_FOUND);
		} else {
			document.getElementById("frmMain").action = "query.BroadcastChatAction.do?action=send";
			submitForm(document.getElementById("frmMain"));
		}
	}
}

function btnExit_click(){
	var msg = confirm(GNR_PER_DAT_ING);
	if (msg) {
		splash();
	}
}

function btnDel_click() {
	document.getElementById("gridMsgTo").removeSelected();
}
