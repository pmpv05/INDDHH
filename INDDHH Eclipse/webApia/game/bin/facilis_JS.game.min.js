(function(){facilis.game.gameAssetsUrl="gameAssets/";facilis.ActivityElement.prototype.showName=function(){this.txtName.visible=true;this.refreshCache()};facilis.ActivityElement.prototype.hideName=function(){this.txtName.visible=false;this.refreshCache()};facilis.ActivityElement.prototype.bonus=function(){this.shadow=new facilis.Shadow("#AAAAFF",0,0,30);var b=this;try{b.updateCache()}catch(c){}setTimeout(function(){b.shadow=null;try{b.updateCache()}catch(a){}},1E3)};facilis.ActivityElement.prototype.greenLight=
null;facilis.ActivityElement.prototype.showCorrect=function(b){if(this.greenLight){this.removeChild(this.greenLight);this.greenLight=null}if(b){this.greenLight=facilis.IconManager.getInstance().getIcon("icons.drop.Permited");this.addChild(this.greenLight);this.greenLight.x=7;this.greenLight.y=7}try{this.updateCache()}catch(c){}};facilis.ActivityElement.prototype.wrongFilter=null;facilis.ActivityElement.prototype.tiltWrong=function(){this.shadow=new facilis.Shadow("#FF0000",0,0,15);var b=this;try{b.updateCache()}catch(c){}setTimeout(function(){b.shadow=
null;try{b.updateCache()}catch(a){}},1E3)}})();
(function(){function b(){if(!b.allowInstantiation)throw Error("Error: Instantiation failed: Use SingletonDemo.getInstance() instead of new.");facilis.EventDispatcher.initialize(this);this.gameState=b.GAME_STOPPED;this.gameMode=b.MODE_DESCRIPTION;this.allItems=[];this.gameItems=[];this.answeredGameItems=[];this.currentAnswer=this.currentElement=null;this.score=0;this.processDescription=""}b.GAME_STOPPED="GAME_STOPPED";b.GAME_ENDED="GAME_ENDED";b.GAME_PLAYING="GAME_PLAYING";b.GAME_PAUSED="GAME_PAUSED";
b.GAME_READY="GAME_READY";b.GAME_NEXT="GAME_NEXT";b.GAME_CORRECT="GAME_CORRECT";b.GAME_BONUS="GAME_BONUS";b.GAME_WRONG="GAME_WRONG";b.INPECT_ELEMENT="INPECT_ELEMENT";b.MODE_NAME="MODE_NAME";b.MODE_DESCRIPTION="MODE_DESCRIPTION";b.MODE_PERFORMER="MODE_PERFORMER";b.allowInstantiation=false;b.getInstance=function(){if(b._instance==null){b.allowInstantiation=true;b._instance=new b;b.allowInstantiation=false}return b._instance};var c=facilis.extend(b,{});c.init=function(){facilis.MultiSelect.MULTISELECT_ENABLED=
false;facilis.View.getInstance().addEventListener(facilis.View.ON_LOAD,this.viewLoad.bind(this));facilis.View.getInstance().addEventListener(facilis.View.ON_SELECT,this.elementSelect.bind(this))};c.play=function(){this.score=0;this.answeredGameItems=[];this.gameItems=this.setShuffled(this.gameItems);this.resetElements();this.setNameVisibles(this.gameMode==facilis.game.GameController.MODE_DESCRIPTION||this.gameMode==facilis.game.GameController.MODE_PERFORMER);this.gameState=facilis.game.GameController.GAME_PLAYING;
this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_PLAYING));this.nextElement()};Object.defineProperty(c,"remaining",{get:function(){return this.gameItems.length}});c.resetElements=function(){for(var a=this.gameItems,d=[];a.length>0;){var e=a.shift();e.init();e.getGameTypeValue()&&e.getGameTypeValue()!=""?d.push(e):this.answeredGameItems.push(e)}this.gameItems=d};c.setNameVisibles=function(a){for(var d=0;d<this.allItems.length;d++)a?this.allItems[d].element.getElement().showName():
this.allItems[d].element.getElement().hideName()};c.end=function(){this.gameState=facilis.game.GameController.GAME_ENDED;for(this.score=facilis.game.ScoreCalculator.calculate(this.answeredGameItems);this.answeredGameItems.length>0;)this.gameItems.push(this.answeredGameItems.shift());this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_ENDED))};c.stop=function(){this.gameState=facilis.game.GameController.GAME_STOPPED;for(this.score=facilis.game.ScoreCalculator.calculate(this.answeredGameItems);this.answeredGameItems.length>
0;)this.gameItems.push(this.answeredGameItems.shift());this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_STOPPED))};c.pause=function(){this.gameState=facilis.game.GameController.GAME_PAUSED;this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_PAUSED))};c.checkCorrectAnswers=function(a){for(var d=0;d<this.gameItems.length;d++)if(this.gameItems[d].element==a&&this.gameItems[d].checkCorrect(this.currentElement)){this.setCorrect(this.gameItems[d]);this.gameItems.splice(d,
1);return true}return false};c.getQuestion=function(){return this.currentElement.getGameTypeValue()};c.setShuffled=function(a){for(var d=[],e=[],f=0;f<a.length;f++)e.push(a[f]);for(;e.length>0;)d.push(e.splice(Math.floor(Math.random()*e.length),1)[0]);return d};c.nextElement=function(){facilis.View.getInstance().unselectAll();if(this.gameItems.length>0){this.currentElement=this.gameItems[0];if(this.currentElement.getGameTypeValue()&&this.currentElement.getGameTypeValue()!=""){this.currentAnswer=new facilis.game.Answer;
this.currentAnswer.start=(new Date).getTime();this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_NEXT))}else{this.answeredGameItems.push(this.gameItems.shift());nextElement()}}else this.end()};c.setCorrect=function(a){this.currentAnswer.end=(new Date).getTime();if(this.currentAnswer.end-this.currentAnswer.start<facilis.game.ScoreCalculator.timeForBonus&&a.answers.length==0){this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_BONUS));a.element.getElement().bonus()}else this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_CORRECT));
this.currentAnswer.correct=true;a.addAnswer(this.currentAnswer);this.currentAnswer=null;this.answeredGameItems.push(a);a.element.getElement().showName();a.element.getElement().showCorrect(true)};c.viewLoad=function(){var a=facilis.View.getInstance().getMainProcessData();this.processDescription=(this.processDescription=a.firstElementChild.firstElementChild.getAttribute("value"))?this.processDescription:"";facilis.game.ScoreCalculator.processName=a.firstElementChild.children[1]?a.firstElementChild.children[1].getAttribute("value"):
"";this.allItems=[];a=facilis.View.getInstance().getElements();for(var d=0;d<a.length;d++)if(a[d].elementType=="task"||a[d].elementType=="esubflow"||a[d].elementType=="csubflow")this.allItems.push(new facilis.game.GameItem(a[d]));this.setNameVisibles(this.gameMode==facilis.game.GameController.MODE_DESCRIPTION||this.gameMode==facilis.game.GameController.MODE_PERFORMER);this.gameItems=this.setShuffled(this.allItems);this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_READY))};c.elementSelect=
function(){var a=facilis.View.getInstance().getSelectedElements()[0];if(a&&a.getElement&&a.getElement()instanceof facilis.ActivityElement)if(this.gameState==facilis.game.GameController.GAME_PLAYING)if(a===this.currentElement.element){this.setCorrect(this.gameItems.shift());this.nextElement()}else if(this.checkCorrectAnswers(a))this.nextElement();else{this.currentAnswer.end=(new Date).getTime();this.currentAnswer.correct=false;this.currentElement.addAnswer(this.currentAnswer);this.currentAnswer=new facilis.game.Answer;
this.currentAnswer.start=(new Date).getTime();facilis.View.getInstance().unselectAll();a.getElement().tiltWrong();this.dispatchEvent(new facilis.Event(facilis.game.GameController.GAME_WRONG))}else for(var d=0;d<this.gameItems.length;d++){if(this.gameItems[d].element==a){this.currentElement=this.gameItems[d];this.dispatchEvent(new facilis.Event(facilis.game.GameController.INPECT_ELEMENT));break}}else if(this.gameState!=facilis.game.GameController.GAME_PLAYING){this.currentElement=null;this.dispatchEvent(new facilis.Event(facilis.game.GameController.INPECT_ELEMENT))}};
c.forceEndGame=function(){this.end()};facilis.game.GameController=facilis.promote(b,"Object")})();
(function(){function b(){}b._disabled=false;b.correct=function(){b.play("correct")};b.error=function(){b.play("error")};b.bonus=function(){b.play("bonus")};b.music=function(){b.play("music")};b.score=function(){b.play("score")};Object.defineProperty(b,"enable",{set:function(c){createjs.Sound.setMute(!c)}});b.play=function(c){b._disabled||createjs.Sound.play(c)};b.handleSoundLoaded=function(c){console.log("Preloaded:",c.id,c.src)};b.init=function(){createjs.Sound.addEventListener("fileload",this.handleSoundLoaded);
createjs.Sound.alternateExtensions=["mp3"];createjs.Sound.registerSounds([{id:"correct",src:"correct.mp3"},{id:"error",src:"error.mp3"},{id:"bonus",src:"bonus.mp3"},{id:"score",src:"score.mp3"},{id:"music",src:"music.mp3"}],facilis.game.gameAssetsUrl+"audio/")};setTimeout(function(){b.init()},500);facilis.game.AudioManager=b})();
(function(){function b(a){this.name="";this.performers=[];this.description="";this._answers=[];this.element=a;this.parseInfo(a.getData())}var c=facilis.extend(b,{});c.init=function(){this._answers=[];this.element.getElement().showCorrect(false)};c.parseInfo=function(a){this.performers=[];this.data=a.firstElementChild;for(a=0;a<this.data.children.length;a++){if(this.data.children[a].getAttribute("label").toLowerCase()=="name")this.name=this.data.children[a].getAttribute("value");if(this.data.children[a].getAttribute("name")==
"documentation")this.description=this.data.children[a].getAttribute("value");if(this.data.children[a].getAttribute("name")=="performers")if(this.data.children[a].children.length>1){for(var d=this.data.children[a].children[1],e=0;e<d.children.length;e++)this.performers.push(d.children[e].firstElementChild.getAttribute("value"));this.performers.sort(Array.CASEINSENSITIVE)}}};c.checkCorrect=function(a){return this.getGameTypeValue()==a.getGameTypeValue()};c.getGameTypeValue=function(){if(facilis.game.GameController.getInstance().gameMode==
facilis.game.GameController.MODE_NAME)return this.name;if(facilis.game.GameController.getInstance().gameMode==facilis.game.GameController.MODE_DESCRIPTION)return this.description;if(facilis.game.GameController.getInstance().gameMode==facilis.game.GameController.MODE_PERFORMER)return this.performers.join(", ")};Object.defineProperty(c,"answers",{get:function(){return this._answers}});c.addAnswer=function(a){this._answers.push(a)};facilis.game.GameItem=facilis.promote(b,"Object")})();
(function(){function b(){}var c=facilis.extend(b,{});c.start=null;c.end=null;c.correct=null;facilis.game.Answer=facilis.promote(b,"Object")})();(function(){function b(){}var c=facilis.extend(b,{});c.name=null;c.date=null;c.score=null;facilis.game.HighScore=facilis.promote(b,"Object")})();
(function(){function b(){}b.timeForBonus=4E3;b.bonusTime=-1E4;b.penaltyTime=1E4;b.score=0;b.bonus=0;b.incorrect=0;b.correct=0;b.avgTime=0;b.totalTime=0;b.userName="";b.processName="";b.details=[];b.highScores={};b.calculate=function(c){b.score=0;b.bonus=0;b.incorrect=0;b.avgTime=0;b.totalTime=0;b.correct=0;b.details=[];for(var a=0,d=0;d<c.length;d++){var e=c[d],f=e.answers,g={};g[facilis.LabelManager.getInstance().getLabel("lbl_element")]=e.name;for(var i=e=0,l=0,j=0;j<f.length;j++){var k=f[j],h=
k.end-k.start;facilis.game.ScoreCalculator.totalTime+=h;if(k.correct){if(h<facilis.game.ScoreCalculator.timeForBonus&&i==0){facilis.game.ScoreCalculator.bonus++;l++;e++;h+=b.bonusTime}else e++;b.correct++}else{h+=facilis.game.ScoreCalculator.penaltyTime;facilis.game.ScoreCalculator.incorrect++;i++}a+=h}g[facilis.LabelManager.getInstance().getLabel("lbl_correct")]=e;g[facilis.LabelManager.getInstance().getLabel("lbl_errors")]=i;g[facilis.LabelManager.getInstance().getLabel("lbl_bonus")]=l;facilis.game.ScoreCalculator.details.push(g)}facilis.game.ScoreCalculator.totalTime/=
1E3;facilis.game.ScoreCalculator.score=1/facilis.game.ScoreCalculator.totalTime*1E6;if(!isFinite(facilis.game.ScoreCalculator.score))facilis.game.ScoreCalculator.score=0;facilis.game.ScoreCalculator.avgTime=facilis.game.ScoreCalculator.totalTime/c.length;facilis.game.ScoreCalculator.addHighScore();facilis.game.ScoreCalculator.score=Math.round(facilis.game.ScoreCalculator.score);return facilis.game.ScoreCalculator.score};b.addHighScore=function(){var c={score:facilis.game.ScoreCalculator.score,name:facilis.game.ScoreCalculator.userName};
facilis.game.HighScoreController.getInstance().addHighScore(facilis.game.ScoreCalculator.processName,c)};b.isHighScore=function(){var c={score:facilis.game.ScoreCalculator.score,name:facilis.game.ScoreCalculator.userName},a=facilis.game.HighScoreController.getInstance().highScores;if(a[a.length-1].score>=c.score)return true;return false};b.getHighScore=function(){if(facilis.game.HighScoreController.getInstance().highScores)return facilis.game.HighScoreController.getInstance().highScores;return null};
b.formatTime=function(c){c=parseInt(c);if(c==0)return 0;var a=c>3600?Math.floor(c/3600)+":":"00:";return a+""+((a&&c%3600<600?"0":"")+Math.floor(c%3600/60)+":")+""+((c%60<10?"0":"")+c%60)};b.formatScore=function(c){c=c.toString();var a=c.indexOf(".");return c.replace(/\d(?=(?:\d{3})+(?:\.|$))/g,function(d,e){return a<0||e<a?d+".":d})};facilis.game.ScoreCalculator=facilis.promote(b,"Object")})();
(function(){function b(){if(!b.allowInstantiation)throw Error("Error: Instantiation failed: Use SingletonDemo.getInstance() instead of new.");this._highScoreModel={};this._highScores=[];this.loadHighScoreModel()}b.allowInstantiation=false;b._instance=null;b.getInstance=function(){if(b._instance==null){b.allowInstantiation=true;b._instance=new b;b.allowInstantiation=false}return b._instance};var c=facilis.extend(b,{});c.addHighScore=function(a,d){a=!a||a==""?"empty":a;this.loadHighScores(a);this._highScores.push(d);
this._highScores.sort(function(e,f){return f.score-e.score});this._highScores.length>10&&this._highScores.pop();this.saveHighScores(a)};Object.defineProperty(c,"highScores",{get:function(){return this._highScores}});c.loadHighScores=function(a){this._highScores=[];if(this._highScoreModel[a])this._highScores=this._highScoreModel[a]};c.loadHighScoreModel=function(){this._highScoreModel={};if(localStorage["facilis.game.HighScore"])this._highScoreModel=JSON.parse(localStorage["facilis.game.HighScore"])};
c.saveHighScores=function(a){this._highScoreModel[a]=this._highScores;localStorage["facilis.game.HighScore"]=JSON.stringify(this._highScoreModel)};facilis.game.HighScoreController=facilis.promote(b,"Object")})();
function WindowManager(){if(!WindowManager.allowInstantiation)throw Error("Error: Instantiation failed: Use SingletonDemo.getInstance() instead of new.");this.onCloseFunctions={};this.openModal=function(b){var c=this.getModalId(),a='<div class="modal" id="'+c+'" data-backdrop="static" data-keyboard="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header">';if(!b.closeButton==false)a+='<button type="button" class="close" onclick="facilis.game.WindowManager.getInstance().closeModal(\''+
c+'\')" data-dismiss="modal" aria-hidden="true">x</button>';a+='<h4 class="modal-title">'+(b.title||"")+'</h4></div><div class="modal-body"></div>';if(b.footer&&b.footer!="")a+='<div class="modal-footer">'+b.footer+"</div>";a+="</div></div></div>";if(b.onClose)this.onCloseFunctions["closeFunction_"+c]=b.onClose;if(!b.contentHTML)if(b.contentUrl){var d=this;$.get(b.contentUrl,null,function(e){$(e.firstChild.outerHTML).appendTo($("#"+c).find(".modal-body"));d.startModal(c)},"xml")}$(a).appendTo("body");
a={};if(b.width)a.width=b.width;if(b.height)a.height=b.height;$("#"+c).find(".modal-dialog").css(a);return $("#"+c)};this.startModal=function(b){$("#"+b).modal({show:true,truebackdrop:"static",keyboard:false})};this.closeModal=function(b){if(this.onCloseFunctions["closeFunction_"+b]){this.onCloseFunctions["closeFunction_"+b]();this.onCloseFunctions["closeFunction_"+b]=null}$("#"+b).modal("hide");setTimeout(function(){$("#"+b).remove()},800)};this.modalCount=0;this.getModalId=function(){this.modalCount++;
return"_modal_"+this.modalCount}}WindowManager.allowInstantiation=false;WindowManager.getInstance=function(){if(WindowManager._instance==null){WindowManager.allowInstantiation=true;WindowManager._instance=new WindowManager;WindowManager.allowInstantiation=false}return WindowManager._instance};facilis.game.WindowManager=WindowManager;
(function(){function b(a){this.actions=a.actions;this.loadBtn=a.loadButton;this.playStopButton=a.startStopButton;this.questionLabel=a.questionLabel;this.taskName=a.taskName;this.taskDescription=a.taskDescription;this.taskPerformer=a.taskPerformer;this.nameInput=a.nameInput;this.countdownEl=a.countdown;this.printerButton=a.printerButton;this.counter=a.counter;this.setup()}var c=facilis.extend(b,{});c.setup=function(){facilis.game.GameController.getInstance().init();facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_PAUSED,
this.onGamePause.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_PLAYING,this.onGamePlaying.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_READY,this.onGameReady.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_STOPPED,this.onGameStop.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_ENDED,
this.onGameEnd.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_NEXT,this.onGameNext.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_CORRECT,this.onGameCorrect.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_WRONG,this.onGameWrong.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.GAME_BONUS,
this.onGameBonus.bind(this));facilis.game.GameController.getInstance().addEventListener(facilis.game.GameController.INPECT_ELEMENT,this.onInspectElement.bind(this));this.loadBtn.addEventListener("change",this.loadGameFile.bind(this));this.playStopButton.addEventListener("click",this.startStopClick.bind(this));this.playStopButton.disabled=true;this.taskDescription.addEventListener("click",this.radioChecked.bind(this));this.taskDescription.checked=true;this.taskPerformer.addEventListener("click",this.radioChecked.bind(this));
this.taskPerformer.checked=false;this.taskName.addEventListener("click",this.radioChecked.bind(this));this.taskName.checked=false;this.countdown=new facilis.game.CountdownTimer(this.countdownEl);this.countdown.displayRemaining=false;this.countdown.x=5;this.countdown.y=5;this.countdown.scaleX=2;this.countdown.scaleY=2;this.countdown.addEventListener(facilis.game.CountdownTimer.TIMER_ENDED,function(){facilis.game.GameController.getInstance().end()});this.questionLabel.disabled=true;this.questionLabel.visible=
false;this.nameInput.addEventListener("change",this.nameInputChanged.bind(this));this.printerButton.addEventListener("click",this.printDocumentation.bind(this));this.checkPlayButton()};c.onGamePlaying=function(){this.loadBtn.disabled=true;this.playStopButton.disabled=true;this.countdown.startTimer(3600,null);this.checkPlayButton();this.playStopButton.playing=true;this.nameInput.disabled=true;this.taskName.disabled=true;this.taskDescription.disabled=true;this.taskPerformer.disabled=true;this.questionLabel.visible=
true;this.countdown.visible=true};c.onGameReady=function(){this.loaded=true;this.loadBtn.disabled=false;this.playStopButton.disabled=false;this.taskName.disabled=false;this.taskDescription.disabled=false;this.taskPerformer.disabled=false;this.playStopButton.playing=false;this.setQuestionText(this.getProcessName()+"\n"+facilis.game.GameController.getInstance().processDescription);this.countdown.visible=false;this.checkPlayButton()};c.onGameEnd=function(){this.loadBtn.disabled=false;this.playStopButton.disabled=
false;this.checkPlayButton();this.taskName.disabled=false;this.taskDescription.disabled=false;this.taskPerformer.disabled=false;this.playStopButton.playing=false;this.nameInput.disabled=false;this.countdown.stopTimer();this.countdown.visible=false;this.questionLabel.visible=true;this.setQuestionText(facilis.game.GameController.getInstance().processDescription);showWhiteBoardWindow()};c.onGameStop=function(){this.loadBtn.disabled=false;this.playStopButton.disabled=false;this.playStopButton.playing=
false;this.checkPlayButton();this.taskName.visible=true;this.taskDescription.visible=true;this.taskPerformer.visible=true;this.nameInput.disabled=false;this.countdown.stopTimer();this.countdown.visible=false;this.questionLabel.visible=true;this.setQuestionText(facilis.game.GameController.getInstance().processDescription)};c.onGameNext=function(){this.setQuestionText(facilis.game.GameController.getInstance().getQuestion());this.counter.innerText=facilis.LabelManager.getInstance().getLabel("lbl_remaining")+
" "+facilis.game.GameController.getInstance().remaining};c.onGameCorrect=function(){facilis.game.AudioManager.correct()};c.onGameWrong=function(){facilis.game.AudioManager.error()};c.onGameBonus=function(){facilis.game.AudioManager.bonus()};c.startStopClick=function(){this.playStopButton.playing?facilis.game.GameController.getInstance().play():facilis.game.GameController.getInstance().stop()};c.endClick=function(){facilis.game.GameController.getInstance().stop()};c.loadClick=function(){};c.radioChecked=
function(a){if(!a.target.disabled)if(this.taskDescription==a.target){facilis.game.GameController.getInstance().gameMode=facilis.game.GameController.MODE_DESCRIPTION;this.taskPerformer.checked=false;this.taskName.checked=false}else if(this.taskPerformer==a.target){facilis.game.GameController.getInstance().gameMode=facilis.game.GameController.MODE_PERFORMER;this.taskDescription.checked=false;this.taskName.checked=false}else if(this.taskName==a.target){facilis.game.GameController.getInstance().gameMode=
facilis.game.GameController.MODE_NAME;this.taskPerformer.checked=false;this.taskDescription.checked=false}};c.onGamePause=function(){};c.onInspectElement=function(){var a;if(facilis.game.GameController.getInstance().processDescription)a=this.getProcessName()+"\n"+facilis.game.GameController.getInstance().processDescription;if(facilis.game.GameController.getInstance().currentElement){var d=facilis.game.GameController.getInstance().currentElement;if(d.name)a=facilis.LabelManager.getInstance().getLabel("lbl_taskName")+
":  "+d.name;if(d.description)a+="\n"+facilis.LabelManager.getInstance().getLabel("lbl_taskDesc")+":  "+d.description;if(d.performers&&d.performers.length>0)a+="\n"+facilis.LabelManager.getInstance().getLabel("lbl_taskPerf")+":  "+d.performers.join(", ")}this.setQuestionText(a)};c.setQuestionText=function(a){this.questionLabel.value=a};c.getProcessName=function(){var a=facilis.View.getInstance().getMainProcessData();if(a){a=a.firstElementChild;for(var d=0;d<a.children.length;d++)if(a.children[d].getAttribute("name")==
"name"||a.children[d].getAttribute("name")=="nameChooser")return a.children[d].getAttribute("value")}return"UnNamed"};c.nameInputChanged=function(){facilis.game.ScoreCalculator.userName=this.nameInput.value;this.checkPlayButton()};c.checkPlayButton=function(){this.playStopButton.disabled=!(this.nameInput.value!="\r"&&this.nameInput.value!=""&&(this.loaded||UrlXpdlLoaded));this.playStopButton.title="";if(this.playStopButton.disabled){var a=facilis.LabelManager.getInstance().getLabel("lbl_mustprovide"),
d="";this.loaded||(d=facilis.LabelManager.getInstance().getLabel("lbl_agamefile"));if((this.nameInput.value=="\r"||this.nameInput.value=="")&&!this.loaded)d+=", ";if(this.nameInput.value=="\r"||this.nameInput.value=="")d+=facilis.LabelManager.getInstance().getLabel("lbl_aplayername");a=a.replace("*",d);this.playStopButton.title=a}};c.printDocumentation=function(){(new facilis.documentation.PdfDocumentGenerator).getDocumentation()};c.loadGameFile=function(a){var d=new FileReader;d=a.target.files;if(d.length!=
0){a=d[0];d=new FileReader;d.onload=function(){loadXpdl(this.result)};d.readAsText(a,"utf-8")}};facilis.game.GamePanel=facilis.promote(b,"Object")})();
(function(){function b(){facilis.EventDispatcher.initialize(this);var d=this;this.interval=null;this.lastTick=0;this.start=function(){this.interval=setInterval(function(){d.lastTick++;d.dispatchEvent(new facilis.Event(b.TIMER))},300)};this.stop=function(){clearInterval(this.interval)};this.getLastTick=function(){return this.lastTick}}function c(d){this.container=d;this.isFinished=false;this.paused=true;this._totalTimePassed=this._totalTimeInSeconds=this._totalTimeInMilliseconds=this._startTime=this._recentTimePassed=
this._lastTime=0;this._whenFinishedCallBack=null;this.tensOfSecondsLeft=this.secondsLeft=this.minutesLeft=0;this.timeSecondsLeft=1E3;this.countTo=-1;this.displayRemaining=true;facilis.EventDispatcher.initialize(this);this.setup()}b.TIMER="timer_timer";var a=facilis.extend(c,{});a.TIMER_ENDED="TIMER_ENDED";a.setup=function(){this.container.innerHTML="";this.container.style.display="table";this.minutes=document.createElement("div");this.minutes.style.display="table-cell";this.minutes.style.width="40%";
this.minutes.style.textAlign="right";this.container.appendChild(this.minutes);this.dots=document.createElement("div");this.dots.style.display="table-cell";this.dots.style.width="20%";this.dots.style.textAlign="center";this.container.appendChild(this.dots);this.dots.innerText=" : ";this.seconds=document.createElement("div");this.seconds.style.display="table-cell";this.seconds.style.width="40%";this.seconds.style.textAlign="left";this.container.appendChild(this.seconds);this.timer=new b(300);this.timer.addEventListener(b.TIMER,
this.loop.bind(this))};a.continueTimer=function(){this._lastTime=this.getTimer();this.paused=false};a.dispose=function(){stopTimer();removeChild(_myTimerClip);this._whenFinishedCallBack=_myTimerClip=null};a.initialise=function(d){_myTimerClip=d};a.pauseTimer=function(){console.log("pausing timer");this.paused=true};a.startTimer=function(d,e){console.log("starting timer for "+d+" seconds");this._totalTimeInSeconds=d;this._whenFinishedCallBack=e;this._totalTimeInMilliseconds=d*1E3;this.timer.start();
this._lastTime=this._startTime=this.getTimer();this._totalTimePassed=0;this.isFinished=this.paused=false};a.stopTimer=function(){this.timer.stop()};a.updateTimeDisplay=function(){this._currentTime=this.getTimer();this._recentTimePassed=this._currentTime-this._lastTime;this._lastTime=this._currentTime;this._totalTimePassed+=this._recentTimePassed;this.timeSecondsLeft=Math.ceil((this._totalTimeInMilliseconds-this._totalTimePassed)/1E3);if(this.timeSecondsLeft<1)this.isFinished=true;var d=this.timeSecondsLeft;
this.displayRemaining||(d=this._totalTimeInSeconds-d);this.minutesLeft=parseInt(d/60);d-=this.minutesLeft*60;this.tensOfSecondsLeft=parseInt(d/10);d-=this.tensOfSecondsLeft*10;this.secondsLeft=d;if(this.minutes.innerText!=this.minutesLeft)this.minutes.innerText=this.minutesLeft;this.seconds.innerText=this.tensOfSecondsLeft+""+this.secondsLeft};a.timerFinished=function(){console.log("timer has finished countdown");this.dispatchEvent(new facilis.Event(facilis.game.CountdownTimer.TIMER_ENDED));this.stopTimer();
this._whenFinishedCallBack!=null&&this._whenFinishedCallBack.call()};a.loop=function(){if(!this.paused){this.updateTimeDisplay();this.isFinished&&this.timerFinished()}};a.getTimer=function(){return(new Date).getTime()};facilis.game.CountdownTimer=facilis.promote(c,"Object")})();
